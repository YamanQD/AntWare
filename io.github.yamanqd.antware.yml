app-id: io.github.yamanqd.antware
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: run_antware.sh

modules:
  - shared-modules/glew/glew.json
  - shared-modules/glu/glu-9.json
  - name: SFML
    buildsystem: cmake
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
        -DSFML_BUILD_EXAMPLES=0
        -DSFML_BUILD_DOC=0
        -DSFML_BUILD_AUDIO=1
        -DSFML_BUILD_WINDOW=1
    post-install:
      - cp /app/pkgconfig/*.pc $FLATPAK_DEST/lib/pkgconfig/
    sources:
      - type: git
        url: https://github.com/SFML/SFML.git
        tag: 2.6.0
        disable-shallow-clone: false
  - name: ASSIMP
    buildsystem: cmake
    config-opts:
      - -DASSIMP_NO_EXPORT=1
        -DASSIMP_BUILD_ALL_EXPORTERS_BY_DEFAULT=0
        -DASSIMP_BUILD_TESTS=0
        -DASSIMP_INJECT_DEBUG_POSTFIX=0
        -DASSIMP_INSTALL_PDB=0
    sources:
      - type: git
        url: https://github.com/assimp/assimp.git
        tag: v5.3.1
        disable-shallow-clone: false
  - name: GLM
    buildsystem: simple
    build-commands:
      -  cp -r ./glm $FLATPAK_DEST/include/
    sources:
      - type: git
        url: https://github.com/g-truc/glm.git
        tag: 0.9.9.8
        disable-shallow-clone: false
  - name: rapidjson
    buildsystem: simple
    build-commands:
      - cp -r ./include/rapidjson $FLATPAK_DEST/include
    sources:
      - type: git
        url: https://github.com/Tencent/rapidjson.git
        tag: v1.1.0
        disable-shallow-clone: false
  - name: antware
    buildsystem: meson
    sources:
      - type: git
        url: https://github.com/YamanQD/AntWare.git
        tag: flatpak-support-setup
        disable-shallow-clone: false

post-install:
  -  update-desktop-database $FLATPAK_DEST/share/applications

finish-args:
  - --socket=x11
  - --device=dri
  - --socket=pulseaudio